var Pebble;null==Pebble&&(Pebble=class{static info(){return"visit www.slidemations.com for info on the Pebble API"}static randomInt(e=0,t=10){return Math.floor(Math.random()*(t-e)+e)}static randomFloat(e=0,t=0,i){return void 0===i&&(i=2),parseFloat(Math.min(e+Math.random()*(t-e),t).toFixed(i))}});Pebble.draggable=[],Pebble.DisplayObject=class{constructor(){this.x=0,this.y=0,this.width=0,this.height=0,this.rotation=0,this.alpha=1,this.visible=!0,this.scaleX=1,this.scaleY=1,this.pivotX=.5,this.pivotY=.5,this.vx=0,this.vy=0,this._layer=0,this.children=[],this.parent=void 0,this.shadow=!1,this.shadowColor="rgba(100, 100, 100, 0.5)",this.shadowOffsetX=3,this.shadowOffsetY=3,this.shadowBlur=3,this.blendMode=void 0,this.frames=[],this.loop=!0,this._currentFrame=0,this.playing=!1,this._draggable=void 0,this._circular=!1,this._interactive=!1,this.previousX=0,this.previousY=0}get gx(){return this.parent?this.x+this.parent.gx:this.x}get gy(){return this.parent?this.y+this.parent.gy:this.y}get layer(){return this._layer}set layer(e){this._layer=e,this.parent&&this.parent.children.sort((e,t)=>e.layer-t.layer)}addChild(e){void 0!==e.parent&&e.parent.removeChild(e),e.parent=this,this.children.push(e)}removeChild(e){if(e.parent!==this)throw new Error(e+"is not a child of "+this);this.children.splice(this.children.indexOf(e),1)}get halfWidth(){return this.width/2}get halfHeight(){return this.height/2}get centerX(){return this.x+this.halfWidth}set centerX(e=0){this.x=e-this.halfWidth}get centerY(){return this.y+this.halfHeight}set centerY(e=0){this.y=e-this.halfHeight}get position(){return{x:this.x,y:this.y}}setPosition(e,t){this.x=e,this.y=t}get localBounds(){return{x:0,y:0,width:this.width,height:this.height}}get globalBounds(){return{x:this.gx,y:this.gy,width:this.gx+this.width,height:this.gy+this.height}}get empty(){return 0===this.children.length}putCenter(e,t=0,i=0){let s=this;e.x=s.x+s.halfWidth-e.halfWidth+t,e.y=s.y+s.halfHeight-e.halfHeight+i}putTop(e,t=0,i=0){let s=this;e.x=s.x+s.halfWidth-e.halfWidth+t,e.y=s.y-e.height+i}putRight(e,t=0,i=0){let s=this;e.x=s.x+s.width+t,e.y=s.y+s.halfHeight-e.halfHeight+i}putBottom(e,t=0,i=0){let s=this;e.x=s.x+s.halfWidth-e.halfWidth+t,e.y=s.y+s.height+i}putLeft(e,t=0,i=0){let s=this;e.x=s.x-e.width+t,e.y=s.y+s.halfHeight-e.halfHeight+i}swapChildren(e,t){let i=this.children.indexOf(e),s=this.children.indexOf(t);if(-1===i||-1===s)throw new Error(`Both objects must be a child of the caller ${this}`);e.childIndex=s,t.childIndex=i,this.children[i]=t,this.children[s]=e}add(...e){e.forEach(e=>this.addChild(e))}remove(...e){e.forEach(e=>this.removeChild(e))}addArray(e=[]){e.forEach(e=>this.addChild(e))}removeArray(e=[]){e.forEach(e=>this.removeChild(e))}get currentFrame(){return this._currentFrame}get circular(){return this._circular}set circular(e){!0===e&&!1===this._circular&&(Object.defineProperties(this,{diameter:{get(){return this.width},set(e){this.width=e,this.height=e},enumerable:!0,configurable:!0},radius:{get(){return this.halfWidth},set(e){this.width=2*e,this.height=2*e},enumerable:!0,configurable:!0}}),this._circular=!0),!1===e&&!0===this._circular&&(delete this.diameter,delete this.radius,this._circular=!1)}get draggable(){return this._draggable}set draggable(e){!0===e&&(draggableSprites.push(this),this._draggable=!0),!1===e&&draggableSprites.splice(draggableSprites.indexOf(this),1)}get interactive(){return this._interactive}set interactive(e){!0===e&&(makeInteractive(this),Pebble.buttons.push(this),this._interactive=!0),!1===e&&(buttons.splice(buttons.indexOf(this),1),this._interactive=!1)}},Pebble.Canvas=class{constructor(e=document.body,t=400,i=400,s="1px dashed black",r="white"){let a=document.createElement("canvas");a.setAttribute("width",t),a.setAttribute("height",i),e.appendChild(a);let h=window.devicePixelRatio||1,n=a.getBoundingClientRect();return a.width=n.width*h,a.height=n.height*h,a.ctx=a.getContext("2d"),a.ctx.scale(h,h),a.setAttribute("style",`width: ${t}px; height: ${i}px; border: ${s}; background: ${r};`),{width:t,height:i,scale:0,ctx:a.ctx,domElement:a,parent:e,aspect:{x:t,y:i},scaleToWindow(e="grey",t){let i,s,r;if(i=window.innerWidth/this.width,s=window.innerHeight/this.height,r=Math.min(i,s),this.domElement.style.transformOrigin="0 0",this.domElement.style.transform="scale("+r+")",parseFloat(this.domElement.style.width)>parseFloat(this.domElement.style.height)){let e=(window.innerHeight-parseFloat(this.domElement.style.height)*i)/2;this.domElement.style.marginTop=e+"px",this.domElement.style.marginBottom=e+"px"}else{let e=(window.innerWidth-parseFloat(this.domElement.style.width)*s)/2;this.domElement.style.marginLeft=e+"px",this.domElement.style.marginRight=e+"px"}this.domElement.style.paddingLeft=0,this.domElement.style.paddingRight=0,this.domElement.style.display="block",this.parent.style.backgroundColor=e,t.scale=r,this.scale=r},cancelReaction(){window.removeEventListener("resize")},exportAsPNG(e=""){try{let t=this.domElement,i="image/png",s=t.toDataURL(i),r=document.createElement("a");return r.download=e,r.href=s,r.dataset.downloadurl=[i,r.download,r.href].join(":"),document.body.appendChild(r),r.click(),document.body.removeChild(r),!0}catch(e){return!1}},exportAsJPG(e=""){try{let t=this.domElement,i="image/jpeg",s=t.toDataURL(i),r=document.createElement("a");return r.download=e,r.href=s,r.dataset.downloadurl=[i,r.download,r.href].join(":"),document.body.appendChild(r),r.click(),document.body.removeChild(r),!0}catch(e){return!1}}}}},Pebble.Stage=class extends Pebble.DisplayObject{constructor(e=0,t=0){super(),this.width=e,this.height=t}},Pebble.render=function(e,t,i=!1,s){let r=e.ctx;function a(t){t.visible&&t.gx<e.width+t.width&&t.gx+t.width>=-t.width&&t.gy<e.height+t.height&&t.gy+t.height>=-t.height&&(r.save(),r.translate(t.x+t.width*t.pivotX,t.y+t.height*t.pivotY),r.rotate(t.rotation),r.globalAlpha=t.alpha*t.parent.alpha,r.scale(t.scaleX,t.scaleY),t.shadow&&(cx.shadowColor=t.shadowColor,r.shadowOffsetX=t.shadowOffsetX,r.shadowOffsetY=t.shadowOffsetY,r.shadowBlur=t.shadowBlur),t.blendMode&&(r.globalCompositeOperation=t.blendMode),t.render&&t.render(r),t.children&&t.children.length>0&&(r.translate(-t.width*t.pivotX,-t.height*t.pivotY),t.children.forEach(e=>{a(e)})),r.restore())}r.clearRect(0,0,e.width,e.height),t.children.forEach(t=>{i?function(t){t.visible&&t.gx<e.width+t.width&&t.gx+t.width>-t.width&&t.gy<e.height+t.height&&t.gy+t.height>-t.height&&(r.save(),void 0!==t.previousX?t.renderX=(t.x-t.previousX)*s+t.previousX:t.renderX=t.x,void 0!==t.previousY?t.renderY=(t.y-t.previousY)*s+t.previousY:t.renderY=t.y,r.translate(t.renderX+t.width*t.pivotX,t.renderY+t.height*t.pivotY),r.rotate(t.rotation),r.globalAlpha=t.alpha*t.parent.alpha,r.scale(t.scaleX,t.scaleY),t.shadow&&(r.shadowColor=t.shadowColor,r.shadowOffsetX=t.shadowOffsetX,r.shadowOffsetY=t.shadowOffsetY,r.shadowBlur=t.shadowBlur),t.blendMode&&(r.globalCompositeOperation=t.blendMode),t.render&&t.render(r),t.children&&t.children.length>0&&(r.translate(-t.width*t.pivotX,-t.height*t.pivotY),t.children.forEach(e=>{a(e)})),r.restore())}(t):a(t)})},Pebble.interpolationData={_fps:60,previous:0,lag:0,get FPS(){return this._fps},set FPS(e){this._fps=e}},Pebble.frameData={times:[],FPS:0},Pebble.refreshLoop=function(){window.requestAnimationFrame(()=>{const e=performance.now();for(;Pebble.frameData.times.length>0&&Pebble.frameData.times[0]<=e-1e3;)Pebble.frameData.times.shift();Pebble.frameData.times.push(e),Pebble.frameData.FPS=Pebble.frameData.times.length,this.refreshLoop()})},Pebble.getLagOffset=function(e,t){let i=1e3/this.interpolationData._fps;e||(e=0);let s=e-this.interpolationData.previous;function r(e){e.children.forEach(e=>{!function e(t){t.previousX=t.x;t.previousY=t.y;t.children&&t.children.length>0&&t.children.forEach(t=>{e(t)})}(e)})}for(s>1e3&&(s=i),this.interpolationData.lag+=s;this.interpolationData.lag>=i;)r(stage),t(),this.interpolationData.lag-=i;return this.interpolationData.previous=e,this.interpolationData.lag/i},Pebble.buttons=[],Pebble.Rectangle=function(e=32,t=32,i="gray",s="none",r=0,a=0,h=0){let n=new RectangleCanvasObject(e,t,i,s,r,a,h);return stage&&stage.addChild(n),n},Pebble.Circle=function(e=32,t="gray",i="none",s=0,r=0,a=0){let h=new CircleCanvasObject(e,t,i,s,r,a);return stage&&stage.addChild(h),h},Pebble.Line=function(e=0,t=0,i=0,s=0,r="none",a=1){let h=new LineCanvasObject(r,a,e,t,i,s);return stage&&stage.addChild(h),h},Pebble.Text=function(e="",t="12px sans-serif",i="black",s=0,r=0){let a=new TextCanvasObject(e,t,i,s,r);return stage&&stage.addChild(a),a},Pebble.Group=function(...e){let t=new ObjectGrouper(e);return stage&&stage.addChild(t),t},Pebble.Sprite=function(e,t=0,i=0){let s=new SpriteCanvasObject(e,t,i);return s.frames.length>0&&Pebble.addStatePlayer(s),stage&&stage.addChild(s),s},Pebble.Button=function(e,t,i){let s=new ButtonObject(e,t,i);return stage&&stage.addChild(s),s},Pebble.Marker=function(e=0,t=0){let i=new MarkerCanvasObject(e,t);return stage&&stage.addChild(i),i};class RectangleCanvasObject extends Pebble.DisplayObject{constructor(e=32,t=32,i="gray",s="none",r=0,a=0,h=0){super(),Object.assign(this,{width:e,height:t,fillStyle:i,strokeStyle:s,lineWidth:r,x:a,y:h}),this.mask=!1}render(e){e.strokeStyle=this.strokeStyle,e.lineWidth=this.lineWidth,e.fillStyle=this.fillStyle,e.beginPath(),e.rect(-this.width*this.pivotX,-this.height*this.pivotY,this.width,this.height),"none"!==this.strokeStyle&&e.stroke(),"none"!==this.fillStyle&&e.fill(),this.mask&&!0===this.mask&&e.clip()}}class MarkerCanvasObject extends Pebble.DisplayObject{constructor(e=0,t=0){super(),Object.assign(this,{x:e,y:t})}}class CircleCanvasObject extends Pebble.DisplayObject{constructor(e=32,t="gray",i="none",s=0,r=0,a=0){super(),this.circular=!0,Object.assign(this,{diameter:e,fillStyle:t,strokeStyle:i,lineWidth:s,x:r,y:a}),this.mask=!1}render(e){e.strokeStyle=this.strokeStyle,e.lineWidth=this.lineWidth,e.fillStyle=this.fillStyle,e.beginPath(),e.arc(this.radius+-this.diameter*this.pivotX,this.radius+-this.diameter*this.pivotY,this.radius,0,2*Math.PI,!1),"none"!==this.strokeStyle&&e.stroke(),"none"!==this.fillStyle&&e.fill(),this.mask&&!0===this.mask&&e.clip()}}class LineCanvasObject extends Pebble.DisplayObject{constructor(e="none",t=0,i=0,s=0,r=0,a=0){super(),Object.assign(this,{strokeStyle:e,lineWidth:t,ax:i,ay:s,bx:r,by:a}),this.lineJoin="rounded"}render(e){e.strokeStyle=this.strokeStyle,e.lineWidth=this.lineWidth,e.lineJoin=this.lineJoin,e.beginPath(),e.moveTo(this.ax,this.ay),e.lineTo(this.bx,this.by),"none"!==this.strokeStyle&&e.stroke()}}class TextCanvasObject extends Pebble.DisplayObject{constructor(e="",t="12px sans-serif",i="black",s,r){if(super(),Object.assign(this,{content:e,font:t,fillStyle:i,x:s,y:r}),this.textBaseline="top",this.strokeText="none",0===this.width){let e=new Pebble.Canvas;e.domElement.style.display="none",e.domElement.style.position="absolute";let t=e.ctx;t.font=this.font,t.strokeStyle=this.strokeStyle,t.lineWidth=this.lineWidth,t.fillStyle=this.fillStyle,this.width=t.measureText(this.content).width,document.body.removeChild(e.domElement)}if(0===this.height){let e=new Pebble.Canvas;e.domElement.style.display="none",e.domElement.style.position="absolute";let t=e.ctx;t.font=this.font,t.strokeStyle=this.strokeStyle,t.lineWidth=this.lineWidth,t.fillStyle=this.fillStyle,this.height=t.measureText("M").width,document.body.removeChild(e.domElement)}}render(e){e.font=this.font,e.strokeStyle=this.strokeStyle,e.lineWidth=this.lineWidth,e.fillStyle=this.fillStyle,this.width=e.measureText(this.content).width,this.height=e.measureText("M").width,e.translate(-this.width*this.pivotX,-this.height*this.pivotY),e.textBaseline=this.textBaseline,e.fillText(this.content,0,0),"none"!==this.strokeText&&e.strokeText()}}class ObjectGrouper extends Pebble.DisplayObject{constructor(...e){super(),e.forEach(e=>this.addChild(e))}addChild(e){e.parent&&e.parent.removeChild(e),e.parent=this,this.children.push(e),this.calculateSize()}removeChild(e){if(e.parent!==this)throw new Error(`${e} is not a child of ${this}`);this.children.splice(this.children.indexOf(e),1),this.calculateSize()}add(...e){e.forEach(e=>{this.addChild(e)})}remove(...e){e.forEach(e=>{this.removeChild(e)})}addArray(e){e.forEach(e=>{this.addChild(e)})}removeArray(...e){e.forEach(e=>{this.removeChild(e)})}calculateSize(){this.children.length>0&&(this._newWidth=0,this._newHeight=0,this.children.forEach(e=>{e.x+e.width>this._newWidth&&(this._newWidth=e.x+e.width),e.y+e.height>this._newHeight&&(this._newHeight=e.y+e.height)}),this.width=this._newWidth,this.height=this._newHeight)}}class SpriteCanvasObject extends Pebble.DisplayObject{constructor(e,t=0,i=0){if(super(),Object.assign(this,{x:t,y:i}),e instanceof Image)this.createFromImage(e);else if(e.frame)this.createFromAtlas(e);else if(e.image&&!e.data)this.createFromTileset(e);else if(e.image&&e.data)this.createFromTilesetFrames(e);else{if(!(e instanceof Array))throw new Error(`The image source ${e} is not recognized`);if(e[0]&&e[0].source)this.createFromAtlasFrames(e);else{if(!(e[0]instanceof Image))throw new Error(`The image sources in ${e} are not recognized`);this.createFromImages(e)}}}createFromImage(e){if(!(e instanceof Image))throw new Error(`${e} is not an image object`);this.source=e,this.sourceX=0,this.sourceY=0,this.width=e.width,this.height=e.height,this.sourceWidth=e.width,this.sourceHeight=e.height}createFromAtlas(e){this.tilesetFrame=e,this.source=this.tilesetFrame.source,this.sourceX=this.tilesetFrame.frame.x,this.sourceY=this.tilesetFrame.frame.y,this.width=this.tilesetFrame.frame.w,this.height=this.tilesetFrame.frame.h,this.sourceWidth=this.tilesetFrame.frame.w,this.sourceHeight=this.tilesetFrame.frame.h}createFromTileset(e){if(!(e.image instanceof Image))throw new Error(`${e.image} is not an image object`);this.source=e.image,this.sourceX=e.x,this.sourceY=e.y,this.width=e.width,this.height=e.height,this.sourceWidth=e.width,this.sourceHeight=e.height}createFromTilesetFrames(e){if(!(e.image instanceof Image))throw new Error(`${e.image} is not an image object`);this.source=e.image,this.frames=e.data,this.sourceX=this.frames[0][0],this.sourceY=this.frames[0][1],this.width=e.width,this.height=e.height,this.sourceWidth=e.width,this.sourceHeight=e.height}createFromAtlasFrames(e){this.frames=e,this.source=e[0].source,this.sourceX=e[0].frame.x,this.sourceY=e[0].frame.y,this.width=e[0].frame.w,this.height=e[0].frame.h,this.sourceWidth=e[0].frame.w,this.sourceHeight=e[0].frame.h}createFromImages(e){this.frames=e,this.source=e[0],this.sourceX=0,this.sourceY=0,this.width=e[0].width,this.height=e[0].width,this.sourceWidth=e[0].width,this.sourceHeight=e[0].height}gotoAndStop(e){if(!(this.frames.length>0&&e<this.frames.length))throw new Error(`Frame number ${e} does not exist`);this.frames[0]instanceof Array?(this.sourceX=this.frames[e][0],this.sourceY=this.frames[e][1]):this.frames[e].frame?(this.sourceX=this.frames[e].frame.x,this.sourceY=this.frames[e].frame.y,this.sourceWidth=this.frames[e].frame.w,this.sourceHeight=this.frames[e].frame.h,this.width=this.frames[e].frame.w,this.height=this.frames[e].frame.h):(this.source=this.frames[e],this.sourceX=0,this.sourceY=0,this.width=this.source.width,this.height=this.source.height,this.sourceWidth=this.source.width,this.sourceHeight=this.source.height),this._currentFrame=e}render(e){e.drawImage(this.source,this.sourceX,this.sourceY,this.sourceWidth,this.sourceHeight,-this.width*this.pivotX,-this.height*this.pivotY,this.width,this.height)}}class ButtonObject extends SpriteCanvasObject{constructor(e,t=0,i=0){super(e,t,i),this.interactive=!0}}function makeInteractive(e){e.press=e.press||void 0,e.release=e.release||void 0,e.over=e.over||void 0,e.out=e.out||void 0,e.tap=e.tap||void 0,e.state="up",e.action="",e.pressed=!1,e.hoverOver=!1,e.update=((t,i)=>{let s=t.hitTestSprite(e);t.isUp&&(e.state="up",e instanceof ButtonObject&&e.gotoAndStop(0)),s&&(e.state="over",e.frames&&3===e.frames.length&&e instanceof ButtonObject&&e.gotoAndStop(1),t.isDown&&(e.state="down",e instanceof ButtonObject&&(3===e.frames.length?e.gotoAndStop(2):e.gotoAndStop(1)))),"down"===e.state&&(e.pressed||(e.press&&e.press(),e.pressed=!0,e.action="pressed")),"over"===e.state&&(e.pressed&&(e.release&&e.release(),e.pressed=!1,e.action="released",t.tapped&&e.tap&&e.tap()),e.hoverOver||(e.over&&e.over(),e.hoverOver=!0)),"up"===e.state&&(e.pressed&&(e.release&&e.release(),e.pressed=!1,e.action="released"),e.hoverOver&&(e.out&&e.out(),e.hoverOver=!1))})}(Pebble.addStatePlayer=function(e){let t=0,i=0,s=0,r=0,a=void 0;function h(h){n(),s=h[0],r=h[1],i=r-s,0===s&&(i+=1,t+=1),1===i&&(i=2,t+=1),e.fps||(e.fps=12);let o=1e3/e.fps;e.gotoAndStop(s),e.playing||(a=setInterval(function(){t<i?(e.gotoAndStop(e.currentFrame+1),t+=1):e.loop&&(e.gotoAndStop(s),t=1)}.bind(this),o),e.playing=!0)}function n(){void 0!==a&&!0===e.playing&&(e.playing=!1,t=0,s=0,r=0,i=0,clearInterval(a))}e.show=function(t){n(),e.gotoAndStop(t)},e.play=function(){e.playing||h([0,e.frames.length-1])},e.stop=function(){e.playing&&(n(),e.gotoAndStop(e.currentFrame))},e.playSequence=h},Pebble.VoxelGrid=class{constructor(){}},null==Pebble)&&(Pebble=class{static randomInt(e=0,t=10){return Math.floor(Math.random()*(t-e)+e)}static randomFloat(e=0,t=0,i){return void 0===i&&(i=2),parseFloat(Math.min(e+Math.random()*(t-e),t).toFixed(i))}});if(Pebble.AssetLoader=class{constructor(){this.toLoad=0,this.loaded=0,this.imageExtensions=["png","jpg","gif"],this.fontExtensions=["ttf","otf","ttc","woff"],this.jsonExtensions=["json"],this.audioExtensions=["mp3","ogg","wav","webm"],this.scriptExtensions=["pbl","js"]}load(e=[],t=!1){return new Promise(i=>{let s=()=>{this.loaded+=1,t&&console.log(this.loaded),this.toLoad===this.loaded&&(this.toLoad=0,this.loaded=0,t&&console.log("Assets finished loading"),i())};t&&console.log("Loading assets..."),this.toLoad=e.length,e.forEach(e=>{let t=e.split(".").pop();-1!==this.imageExtensions.indexOf(t)?this.loadImage(e,s):-1!==this.fontExtensions.indexOf(t)?this.loadFont(e,s):-1!==this.jsonExtensions.indexOf(t)?this.loadJson(e,s):-1!==this.audioExtensions.indexOf(t)?this.loadSound(e,s):-1!==this.scriptExtensions.indexOf(t)?this.loadScript(e,s):console.error("File type not recognized: "+e)})})}loadImage(e,t){let i=new Image;i.addEventListener("load",t,!1),this[e]=i,i.src=e}loadScript(e,t){let i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType="text",i.onload=(s=>{if(200===i.status){let s={source:i.responseText,execute(){return new Promise(e=>{let t=document.createElement("script");t.innerHTML=this.source,document.body.appendChild(t),e()})}};this[e]=s,t()}}),i.send()}loadFont(e,t){let i=e.split("/").pop().split(".")[0],s=document.createElement("style"),r="@font-face {font-family: '"+i+"'; src: url('"+e+"');}";s.appendChild(document.createTextNode(r)),document.head.appendChild(s),t()}loadJson(e,t){let i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType="text",i.onload=(s=>{if(200===i.status){let s=JSON.parse(i.responseText);s.name=e,this[s.name]=s,s.frames?this.createTilesetFrames(s,e,t):t()}}),i.send()}createTilesetFrames(e,t,i){let s=t.replace(/[^\/]*$/,"")+e.meta.image,r=new Image;r.addEventListener("load",()=>{this[s]=r,Object.keys(e.frames).forEach(t=>{this[t]=e.frames[t],this[t].source=r}),i()},!1),r.src=s}loadSound(e,t){let i=Pebble.Sound(e,t);i.name=e,this[i.name]=i}},void 0===Pebble.DisplayObject||null===Pebble.DisplayObject)throw new Error("You must have Pebble-2d installed before you can use Pebble-collisions");function hitTestPoint(e,t){let i,s,r,a,h,n,o,l,d;return"rectangle"===(i=t.radius?"circle":"rectangle")&&(s=t.x,r=t.x+t.width,a=t.y,h=t.y+t.height,d=e.x>s&&e.x<r&&e.y>a&&e.y<h),"circle"===i&&(n=e.x-t.centerX,o=e.y-t.centerY,d=(l=Math.sqrt(n*n+o*o))<t.radius),d}function hitTestCircle(e,t,i=!1){let s,r,a,h,n;return i?(s=t.gx+t.radius-(e.gx+e.radius),r=t.gy+t.radius-(e.gy+e.radius)):(s=t.centerX-e.centerX,r=t.centerY-e.centerY),n=(a=Math.sqrt(s*s+r*r))<(h=e.radius+t.radius)}function circleCollision(e,t,i=!1,s=!1){let r,a,h,n,o,l,d,c={},u=!1;if(s?(n=t.gx+t.radius-(e.gx+e.radius),o=t.gy+t.radius-(e.gy+e.radius)):(n=t.centerX-e.centerX,o=t.centerY-e.centerY),(r=Math.sqrt(n*n+o*o))<(a=e.radius+t.radius)){u=!0,h=a-r,h+=.3,l=n/r,d=o/r,e.x-=h*l,e.y-=h*d,i&&(c.x=o,c.y=-n,bounceOffSurface(e,c))}return u}function movingCircleCollision(e,t,i=!1){let s,r,a,h,n={},o={},l={},d={},c={},u=!1;if(e.mass=e.mass||1,t.mass=t.mass||1,i?(n.vx=t.gx+t.radius-(e.gx+e.radius),n.vy=t.gy+t.radius-(e.gy+e.radius)):(n.vx=t.centerX-e.centerX,n.vy=t.centerY-e.centerY),n.magnitude=Math.sqrt(n.vx*n.vx+n.vy*n.vy),s=e.radius+t.radius,n.magnitude<s){u=!0,r=s-n.magnitude,r+=.3,n.dx=n.vx/n.magnitude,n.dy=n.vy/n.magnitude,n.vxHalf=Math.abs(n.dx*r/2),n.vyHalf=Math.abs(n.dy*r/2),a=e.x>t.x?1:-1,h=e.y>t.y?1:-1,e.x=e.x+n.vxHalf*a,e.y=e.y+n.vyHalf*h,t.x=t.x+n.vxHalf*-a,t.y=t.y+n.vyHalf*-h,n.lx=n.vy,n.ly=-n.vx;let i=e.vx*n.dx+e.vy*n.dy;o.x=i*n.dx,o.y=i*n.dy;let g=e.vx*(n.lx/n.magnitude)+e.vy*(n.ly/n.magnitude);l.x=g*(n.lx/n.magnitude),l.y=g*(n.ly/n.magnitude);let m=t.vx*n.dx+t.vy*n.dy;d.x=m*n.dx,d.y=m*n.dy;let p=t.vx*(n.lx/n.magnitude)+t.vy*(n.ly/n.magnitude);c.x=p*(n.lx/n.magnitude),c.y=p*(n.ly/n.magnitude),e.bounce={},e.bounce.x=l.x+d.x,e.bounce.y=l.y+d.y,t.bounce={},t.bounce.x=o.x+c.x,t.bounce.y=o.y+c.y,e.vx=e.bounce.x/e.mass,e.vy=e.bounce.y/e.mass,t.vx=t.bounce.x/t.mass,t.vy=t.bounce.y/t.mass}return u}function multipleCircleCollision(e,t=!1){for(let s=0;s<e.length;s++){var i=e[s];for(let r=s+1;r<e.length;r++){movingCircleCollision(i,e[r],t)}}}function hitTestRectangle(e,t,i=!1){let s,r,a,h,n;return s=!1,i?(h=e.gx+e.halfWidth-(t.gx+t.halfWidth),n=e.gy+e.halfHeight-(t.gy+t.halfHeight)):(h=e.centerX-t.centerX,n=e.centerY-t.centerY),r=e.halfWidth+t.halfWidth,a=e.halfHeight+t.halfHeight,s=Math.abs(h)<r&&Math.abs(n)<a}function rectangleCollision(e,t,i=!1,s=!0){let r,a,h,n,o,l,d;return s?(l=e.gx+e.halfWidth-(t.gx+t.halfWidth),d=e.gy+e.halfHeight-(t.gy+t.halfHeight)):(l=e.centerX-t.centerX,d=e.centerY-t.centerY),a=e.halfWidth+t.halfWidth,h=e.halfHeight+t.halfHeight,Math.abs(l)<a&&Math.abs(d)<h&&((n=a-Math.abs(l))>=(o=h-Math.abs(d))?(d>0?(r="top",e.y=e.y+o):(r="bottom",e.y=e.y-o),i&&(e.vy*=-1)):(l>0?(r="left",e.x=e.x+n):(r="right",e.x=e.x-n),i&&(e.vx*=-1))),r}function hitTestCircleRectangle(e,t,i=!1){let s,r,a,h,n,o;if(i?(a=e.gx,h=e.gy,n=t.gx,o=t.gy):(a=e.x,h=e.y,n=t.x,o=t.y),"topMiddle"===(s=h<o-t.halfHeight?a<n-1-t.halfWidth?"topLeft":a>n+1+t.halfWidth?"topRight":"topMiddle":h>o+t.halfHeight?a<n-1-t.halfWidth?"bottomLeft":a>n+1+t.halfWidth?"bottomRight":"bottomMiddle":a<n-t.halfWidth?"leftMiddle":"rightMiddle")||"bottomMiddle"===s||"leftMiddle"===s||"rightMiddle"===s)r=hitTestRectangle(e,t,i);else{let a={};switch(s){case"topLeft":a.x=n,a.y=o;break;case"topRight":a.x=n+t.width,a.y=o;break;case"bottomLeft":a.x=n,a.y=o+t.height;break;case"bottomRight":a.x=n+t.width,a.y=o+t.height}r=hitTestCirclePoint(e,a,i)}return r?s:r}function hitTestCirclePoint(e,t,i=!1){return t.diameter=1,t.radius=.5,t.centerX=t.x,t.centerY=t.y,t.gx=t.x,t.gy=t.y,hitTestCircle(e,t,i)}function circleRectangleCollision(e,t,i=!1,s=!1){let r,a,h,n,o,l;if(s?(h=e.gx,n=e.gy,o=t.gx,l=t.gy):(h=e.x,n=e.y,o=t.x,l=t.y),"topMiddle"===(r=n<l-t.halfHeight?h<o-1-t.halfWidth?"topLeft":h>o+1+t.halfWidth?"topRight":"topMiddle":n>l+t.halfHeight?h<o-1-t.halfWidth?"bottomLeft":h>o+1+t.halfWidth?"bottomRight":"bottomMiddle":h<o-t.halfWidth?"leftMiddle":"rightMiddle")||"bottomMiddle"===r||"leftMiddle"===r||"rightMiddle"===r)a=rectangleCollision(e,t,i,s);else{let h={};switch(r){case"topLeft":h.x=o,h.y=l;break;case"topRight":h.x=o+t.width,h.y=l;break;case"bottomLeft":h.x=o,h.y=l+t.height;break;case"bottomRight":h.x=o+t.width,h.y=l+t.height}a=circlePointCollision(e,h,i,s)}return a?r:a}function circlePointCollision(e,t,i=!1,s=!1){return t.diameter=1,t.radius=.5,t.centerX=t.x,t.centerY=t.y,t.gx=t.x,t.gy=t.y,circleCollision(e,t,i,s)}function bounceOffSurface(e,t){let i,s,r={},a={},h={},n=e.mass||1;t.lx=t.y,t.ly=-t.x,t.magnitude=Math.sqrt(t.x*t.x+t.y*t.y),t.dx=t.x/t.magnitude,t.dy=t.y/t.magnitude,i=e.vx*t.dx+e.vy*t.dy,r.vx=i*t.dx,r.vy=i*t.dy,s=e.vx*(t.lx/t.magnitude)+e.vy*(t.ly/t.magnitude),a.vx=s*(t.lx/t.magnitude),a.vy=s*(t.ly/t.magnitude),a.vx*=-1,a.vy*=-1,h.x=r.vx+a.vx,h.y=r.vy+a.vy,e.vx=h.x/n,e.vy=h.y/n}(Pebble.contain=function(e,t,i=!1,s=(()=>{})){let r,a=t.x,h=t.y,n=t.width,o=t.height;return e.x<a&&(i&&(e.vx*=-1),e.mass&&(e.vx/=e.mass),e.x=a,r="left"),e.y<h&&(i&&(e.vy*=-1),e.mass&&(e.vy/=e.mass),e.y=h,r="top"),e.x+e.width>n&&(i&&(e.vx*=-1),e.mass&&(e.vx/=e.mass),e.x=n-e.width,r="right"),e.y+e.height>o&&(i&&(e.vy*=-1),e.mass&&(e.vy/=e.mass),e.y=o-e.height,r="bottom"),r&&s&&s(r),r},Pebble.hit=function(e,t,i=!1,s=!1,r,a){let h,n=void 0!==e.parent,o=void 0!==t.parent;return n&&t instanceof Array||o&&e instanceof Array?function(){if(e instanceof Array){let[e,t]=[t,e]}for(let i=t.length-1;i>=0;i--){let s=t[i];(h=l(e,s))&&a&&a(h,s)}}():(h=l(e,t))&&a&&a(h),h;function l(e,t){let a=void 0!==e.parent,h=void 0!==t.parent;if(a&&h)return e.diameter&&t.diameter?function(e,t){return i?e.vx+e.vy!==0&&t.vx+t.vy!==0?movingCircleCollision(e,t,r):circleCollision(e,t,s,r):hitTestCircle(e,t)}(e,t):e.diameter&&!t.diameter?function(e,t){return i?circleRectangleCollision(e,t,s,r):hitTestCircleRectangle(e,t,r)}(e,t):function(e,t){return i?rectangleCollision(e,t,s,r):hitTestRectangle(e,t,r)}(e,t);if(h&&void 0!==e.x&&void 0!==e.y)return hitTestPoint(e,t);throw new Error(`I'm sorry, ${e} and ${t} cannot be use together in a collision test.'`)}},Pebble.Storage=class{constructor(){if(this.databases=[],this.openDatabases=[],window.localStorage.length>0)for(let e=0;e<window.localStorage.length;e++){let t=window.localStorage.key(e),i=window.localStorage.getItem(t);"{id:"==i.slice(0,4)&&"string"==typeof(i=JSON.parse(i)).id&&this.databases.push(i)}}createDB(e=""){let t=!0;if(this.databases.length>0&&this.databases.forEach(i=>{i.id===e&&(t=!1)}),!0===t){let t={id:e,db:{storage:[]}};return this.databases.push(t),window.localStorage.setItem(e,JSON.stringify(t)),!0}return!1}removeDB(e=""){let t=this.databases.find(t=>t.id===e);if(t.id){let e=this.databases.indexOf(t);return window.localStorage.removeItem(t.id),this.databases.splice(e,1),!0}return!1}open(e="",t){try{let i=JSON.parse(window.localStorage.getItem(e));this.openDatabases.push(i);let s=this.openDatabases.indexOf(i);return Object.assign(this.openDatabases[s].db,{createNode(e="",t){this.storage.length>0&&this.storage.forEach(t=>{if(e===t.name)throw new Error("This name has already been taken")});let i={name:e,value:t,type:typeof t};return this.storage.push(i),!0},removeNode(e){let t=this.storage.find(t=>t.name===e),i=this.storage.indexOf(t);return this.storage.splice(i,1),!0},updateNode(e="",t){if(this.storage.length>0)try{this.storage.forEach(i=>{if(i.name===e&&i.type===typeof t)i.value=t;else if(void 0===i.name)throw new Error})}catch(t){throw new Error(`Node ${e} either doesn't exist, or the value you tried to update is not of the same type`)}},getNode(e=""){console.log(this.storage);for(let t of this.storage)if(t.name===e)return t.value;return!1},removeAll(){},getAll(){}}),t&&t(this.openDatabases[s].db),!0}catch(e){return this.openDatabases.pop(),!1}}checkDB(e=""){return!!this.open(e)&&(this.close(e),!0)}close(e=""){let t=this.openDatabases.find(t=>t.id===e);window.localStorage.setItem(t.id,JSON.stringify(t));let i=this.openDatabases.indexOf(t);if(this.openDatabases.splice(i,1),this.databases=[],window.localStorage.length>0)for(let e=0;e<window.localStorage.length;e++){let t=window.localStorage.key(e),i=window.localStorage.getItem(t);"string"==typeof(i=JSON.parse(i)).id&&this.databases.push(i)}return!0}removeAll(){return this.databases.forEach(e=>this.removeDB(e.id)),!0}closeAll(){return this.openDatabases.forEach(e=>this.close(e.id)),!0}},null==Pebble)&&(Pebble=class{static info(){return"visit www.slidemations.com for info on the Pebble API"}static randomInt(e=0,t=10){return Math.floor(Math.random()*(t-e)+e)}static randomFloat(e=0,t=0,i){return void 0===i&&(i=2),parseFloat(Math.min(e+Math.random()*(t-e),t).toFixed(i))}});(Pebble.Keyboard=function(e=0,t=window){let i={};return i.eObj=t,i.code=e,i.isDown=!1,i.isUp=!0,i.press=void 0,i.release=void 0,i.downHandler=function(e){e.keyCode===i.code&&(i.isUp&&i.press&&i.press(),i.isDown=!0,i.isUp=!1),e.preventDefault()},i.upHandler=function(e){e.keyCode===i.code&&(i.isDown&&i.release&&i.release(),i.isDown=!1,i.isUp=!0),e.preventDefault()},i.eObj.addEventListener("keydown",i.downHandler.bind(i),!1),i.eObj.addEventListener("keyup",i.upHandler.bind(i),!1),i},Pebble.Pointer=function(e=document.body,t=1){let i={element:e,scale:t,_x:0,_y:0,get x(){return this._x/this.scale},get y(){return this._y/this.scale},get centerX(){return this.x},get centerY(){return this.y},get position(){return{x:this.x,y:this.y}},isDown:!1,isUp:!0,tapped:!1,downTime:0,elapsedTime:0,press:void 0,release:void 0,tap:void 0,dragSprite:null,dragOffsetX:0,dragOffsetY:0,moveHandler(e){let t=e.target;this._x=e.pageX-t.offsetLeft,this._y=e.pageY-t.offsetTop,e.preventDefault()},touchmoveHandler(e){let t=e.target;this._x=e.targetTouches[0].pageX-t.offsetLeft,this._y=e.targetTouches[0].pageY-t.offsetTop,e.preventDefault()},downHandler(e){this.isDown=!0,this.isUp=!1,this.tapped=!1,this.downTime=Date.now(),this.press&&this.press(),e.preventDefault()},touchstartHandler(e){let t=e.target;this._x=e.targetTouches[0].pageX-t.offsetLeft,this._y=e.targetTouches[0].pageY-t.offsetTop,this.isDown=!0,this.isUp=!1,this.tapped=!1,this.downTime=Date.now(),this.press&&this.press(),e.preventDefault()},upHandler(e){this.elapsedTime=Math.abs(this.downTime-Date.now()),this.elapsedTime<=200&&!1===this.tapped&&(this.tapped=!0,this.tap&&this.tap()),this.isUp=!0,this.isDown=!1,this.release&&this.release(),e.preventDefault()},touchendHandler(e){this.elapsedTime=Math.abs(this.downTime-Date.now()),this.elapsedTime<=200&&!1===this.tapped&&(this.tapped=!0,this.tap&&this.tap()),this.isUp=!0,this.isDown=!1,this.release&&this.release(),e.preventDefault()},hitTestSprite(e){let t=!1;if(e.circular){let i=this.x-(e.gx+e.radius),s=this.y-(e.gy+e.radius);t=Math.sqrt(i*i+s*s)<e.radius}else{let i=e.gx,s=e.gx+e.width,r=e.gy,a=e.gy+e.height;t=this.x>i&&this.x<s&&this.y>r&&this.y<a}return t},updateDragAndDrop(e){if(this.isDown)if(null===this.dragSprite)for(let t=e.length-1;t>-1;t--){let i=e[t];if(this.hitTestSprite(i)&&i.draggable){this.dragOffsetX=this.x-i.gx,this.dragOffsetY=this.y-i.gy,this.dragSprite=i;let t=i.parent.children;t.splice(t.indexOf(i),1),t.push(i),e.splice(e.indexOf(i),1),e.push(i);break}}else this.dragSprite.x=this.x-this.dragOffsetX,this.dragSprite.y=this.y-this.dragOffsetY;this.isUp&&(this.dragSprite=null),e.some(e=>this.hitTestSprite(e)&&e.draggable?(this.element.style.cursor="pointer",!0):(this.element.style.cursor="auto",!1))}};return e.addEventListener("mousemove",i.moveHandler.bind(i),!1),e.addEventListener("mousedown",i.downHandler.bind(i),!1),window.addEventListener("mouseup",i.upHandler.bind(i),!1),e.addEventListener("touchmove",i.touchmoveHandler.bind(i),!1),e.addEventListener("touchstart",i.touchstartHandler.bind(i),!1),window.addEventListener("touchend",i.touchendHandler.bind(i),!1),e.style.touchAction="none",i},Pebble.sleep=function(e=0){let t=new Date,i=null;do{i=new Date}while(i-t<e)},Pebble.distance=function(e,t){let i=t.centerX-e.centerX,s=t.centerY-e.centerY;return Math.sqrt(i*i+s+s)},Pebble.followEase=function(e,t,i=.1){let s=t.centerX-e.centerX,r=t.centerY-e.centerY;Math.sqrt(s*s+r*r)>=1&&(e.x+=s*i,e.y+=r*i)},Pebble.followConstant=function(e,t,i=.1){let s=t.centerX-e.centerX,r=t.centerY-e.centerY,a=Math.sqrt(s*s+r*r);a>=1*i&&(e.x+=s/a*i,e.y+=r/a*i)},Pebble.angle=function(e,t){return Math.atan2(t.centerY-e.centerY,t.centerX-e.centerX)},Pebble.rotateSprite=function(e,t,i,s){void 0===e.angle&&(e.angle=0),e.angle+=s,e.x=t.centerX-e.parent.x+i*Math.cos(e.angle)-e.halfWidth,e.y=t.centerY-e.parent.y+i*Math.sin(e.angle)-e.halfWidth},null==Pebble)&&(Pebble=class{static info(){return"visit www.slidemations.com for info on the Pebble API"}static randomInt(e=0,t=10){return Math.floor(Math.random()*(t-e)+e)}static randomFloat(e=0,t=0,i){return void 0===i&&(i=2),parseFloat(Math.min(e+Math.random()*(t-e),t).toFixed(i))}});(Pebble.Webcam=function(e=document.body,t=100,i=100,s="margin: 0px auto;border: 1px dashed black;width: 200px;height: 200px;background: # 666;"){let r=document.createElement("video");r.setAttribute("style",s),r.autoplay=!0,r.width=t,r.height=i,navigator.mediaDevices.getUserMedia&&navigator.mediaDevices.getUserMedia({video:!0}).then(e=>r.srcObject=e).catch(e=>console.log(e));let a={domElement:r,stop:function(){let e=this.domElement.srcObject.getTracks();for(var t=0;t<e.length;t++){e[t].stop()}this.domElement.srcObject=null},start:function(){navigator.mediaDevices.getUserMedia&&navigator.mediaDevices.getUserMedia({video:!0}).then(e=>this.domElement.srcObject=e).catch(e=>console.log(e))},captureFrame:function(e="",t="image/png"){if(void 0===Pebble.DisplayObject||void 0===Pebble.DisplayObject)throw new Error("Pebble2d is required for this action");{let i=new Pebble.Canvas(document.body,this.domElement.width,this.domElement.height,"none","rgba(0,0,0,0)");if(i.domElement.style.display="none",i.domElement.style.position="absolute",i.ctx.drawImage(this.domElement,0,0,this.domElement.width,this.domElement.height),e)return"image/png"===t&&i.exportAsPNG(e),"image/jpeg"===t?i.exportAsJPG(e):i.exportAsPNG(e),void document.body.removeChild(i.domElement);{let e=i.domElement.toDataURL(t);return document.body.removeChild(i.domElement),e}}}};return e.appendChild(a.domElement),a},null==Pebble)&&(Pebble=class{static info(){return"visit www.slidemations.com for info on the Pebble API"}static randomInt(e=0,t=10){return Math.floor(Math.random()*(t-e)+e)}static randomFloat(e=0,t=0,i){return void 0===i&&(i=2),parseFloat(Math.min(e+Math.random()*(t-e),t).toFixed(i))}});Pebble.Matrix=class{constructor(e,t){this.rows=e,this.cols=t,this.data=Array(this.rows).fill().map(()=>Array(this.cols).fill(0))}copy(){let e=new Pebble.Matrix(this.rows,this.cols);for(let t=0;t<this.rows;t++)for(let i=0;i<this.cols;i++)e.data[t][i]=this.data[t][i];return e}static fromArray(e){return new Pebble.Matrix(e.length,1).map((t,i)=>e[i])}static subtract(e,t){if(e.rows===t.rows&&e.cols===t.cols)return new Pebble.Matrix(e.rows,e.cols).map((i,s,r)=>e.data[s][r]-t.data[s][r]);console.log("Columns and Rows of A must match Columns and Rows of B.")}toArray(){let e=[];for(let t=0;t<this.rows;t++)for(let i=0;i<this.cols;i++)e.push(this.data[t][i]);return e}randomize(){return this.map(e=>2*Math.random()-1)}add(e){return e instanceof Pebble.Matrix?this.rows!==e.rows||this.cols!==e.cols?void console.log("Columns and Rows of A must match Columns and Rows of B."):this.map((t,i,s)=>t+e.data[i][s]):this.map(t=>t+e)}static transpose(e){return new Pebble.Matrix(e.cols,e.rows).map((t,i,s)=>e.data[s][i])}static multiply(e,t){if(e.cols===t.rows)return new Pebble.Matrix(e.rows,t.cols).map((i,s,r)=>{let a=0;for(let i=0;i<e.cols;i++)a+=e.data[s][i]*t.data[i][r];return a});console.log("Columns of A must match rows of B.")}multiply(e){return e instanceof Pebble.Matrix?this.rows!==e.rows||this.cols!==e.cols?void console.log("Columns and Rows of A must match Columns and Rows of B."):this.map((t,i,s)=>t*e.data[i][s]):this.map(t=>t*e)}map(e){for(let t=0;t<this.rows;t++)for(let i=0;i<this.cols;i++){let s=this.data[t][i];this.data[t][i]=e(s,t,i)}return this}static map(e,t){return new Pebble.Matrix(e.rows,e.cols).map((i,s,r)=>t(e.data[s][r],s,r))}print(){return console.table(this.data),this}serialize(){return JSON.stringify(this)}static deserialize(e){"string"==typeof e&&(e=JSON.parse(e));let t=new Pebble.Matrix(e.rows,e.cols);return t.data=e.data,t}},Pebble.ActivationFunction=class{constructor(e,t){this.func=e,this.dfunc=t}};let sigmoid=new Pebble.ActivationFunction(e=>1/(1+Math.exp(-e)),e=>e*(1-e)),tanh=new Pebble.ActivationFunction(e=>Math.tanh(e),e=>1-e*e);if(Pebble.NeuralNetwork=class{constructor(e,t,i){if(e instanceof Pebble.NeuralNetwork){let t=e;this.input_nodes=t.input_nodes,this.hidden_nodes=t.hidden_nodes,this.output_nodes=t.output_nodes,this.weights_ih=t.weights_ih.copy(),this.weights_ho=t.weights_ho.copy(),this.bias_h=t.bias_h.copy(),this.bias_o=t.bias_o.copy()}else this.input_nodes=e,this.hidden_nodes=t,this.output_nodes=i,this.weights_ih=new Pebble.Matrix(this.hidden_nodes,this.input_nodes),this.weights_ho=new Pebble.Matrix(this.output_nodes,this.hidden_nodes),this.weights_ih.randomize(),this.weights_ho.randomize(),this.bias_h=new Pebble.Matrix(this.hidden_nodes,1),this.bias_o=new Pebble.Matrix(this.output_nodes,1),this.bias_h.randomize(),this.bias_o.randomize();this.setLearningRate(),this.setActivationFunction()}predict(e){let t=Pebble.Matrix.fromArray(e),i=Pebble.Matrix.multiply(this.weights_ih,t);i.add(this.bias_h),i.map(this.activation_function.func);let s=Pebble.Matrix.multiply(this.weights_ho,i);return s.add(this.bias_o),s.map(this.activation_function.func),s.toArray()}setLearningRate(e=.1){this.learning_rate=e}setActivationFunction(e=sigmoid){this.activation_function=e}train(e,t){let i=Pebble.Matrix.fromArray(e),s=Pebble.Matrix.multiply(this.weights_ih,i);s.add(this.bias_h),s.map(this.activation_function.func);let r=Pebble.Matrix.multiply(this.weights_ho,s);r.add(this.bias_o),r.map(this.activation_function.func);let a=Pebble.Matrix.fromArray(t),h=Pebble.Matrix.subtract(a,r),n=Pebble.Matrix.map(r,this.activation_function.dfunc);n.multiply(h),n.multiply(this.learning_rate);let o=Pebble.Matrix.transpose(s),l=Pebble.Matrix.multiply(n,o);this.weights_ho.add(l),this.bias_o.add(n);let d=Pebble.Matrix.transpose(this.weights_ho),c=Pebble.Matrix.multiply(d,h),u=Pebble.Matrix.map(s,this.activation_function.dfunc);u.multiply(c),u.multiply(this.learning_rate);let g=Pebble.Matrix.transpose(i),m=Pebble.Matrix.multiply(u,g);this.weights_ih.add(m),this.bias_h.add(u)}serialize(){return JSON.stringify(this)}static deserialize(e){"string"==typeof e&&(e=JSON.parse(e));let t=new NeuralNetwork(e.input_nodes,e.hidden_nodes,e.output_nodes);return t.weights_ih=Matrix.deserialize(e.weights_ih),t.weights_ho=Matrix.deserialize(e.weights_ho),t.bias_h=Matrix.deserialize(e.bias_h),t.bias_o=Matrix.deserialize(e.bias_o),t.learning_rate=e.learning_rate,t}copy(){return new NeuralNetwork(this)}mutate(e){this.weights_ih.map(e),this.weights_ho.map(e),this.bias_h.map(e),this.bias_o.map(e)}},void 0===Pebble.DisplayObject||null===Pebble.DisplayObject)throw new Error("You must execute Pebble-2d.js before you can use this");Pebble.World=class{constructor(e){this.scenes=[],this.currentScene=0,this.stage=e;this.cGroup=class extends Pebble.DisplayObject{constructor(e,t){super(),this.width=e,this.height=t}addChild(e){e.parent&&e.parent.removeChild(e),e.parent=this,this.children.push(e)}removeChild(e){if(e.parent!==this)throw new Error(`${e} is not a child of ${this}`);this.children.splice(this.children.indexOf(e),1)}add(...e){e.forEach(e=>{this.addChild(e)})}remove(...e){e.forEach(e=>{this.removeChild(e)})}addArray(e){e.forEach(e=>{this.addChild(e)})}removeArray(...e){e.forEach(e=>{this.removeChild(e)})}}}addNewScene(e=function(e,t,i){},t=function(e,t,i){}){let i={group:new this.cGroup(this.stage.width,this.stage.height),prepare:()=>e(this,i.objects,i.group),update:()=>t(this,i.objects,i.group),objects:{}};i.group.parent||this.stage.add(i.group),this.scenes.push(i),i.group.visible=0===this.scenes.indexOf(i),i.group.visible&&i.prepare()}nextScene(){if(this.currentScene<this.scenes.length-1){this.scenes[this.currentScene].group.visible=!1,this.currentScene++;this.scenes[this.currentScene].group.visible=!0;this.scenes[this.currentScene].prepare()}else this.scenes[this.currentScene].group.visible=!1,this.currentScene=0,this.scenes[this.currentScene].prepare(),this.scenes[this.currentScene].group.visible=!0}gotoScene(e){Number.isInteger(e)&&e>=0&&e<this.scenes.length&&(this.Scene.group.visible=!1,this.currentScene=e,this.scenes[this.currentScene].prepare(),this.scenes[this.currentScene].group.visible=!0)}get Scene(){return this.scenes[this.currentScene]}},Pebble.shoot=function(e,t,i,s,r,a){let h=a();h.x=e.centerX-h.halfWidth+i*Math.cos(t),h.y=e.centerY-h.halfHeight+i*Math.sin(t),h.vx=Math.cos(t)*s,h.vy=Math.sin(t)*s,r.push(h)};